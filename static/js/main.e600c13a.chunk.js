(this.webpackJsonprquood=this.webpackJsonprquood||[]).push([[0],{47:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(31),a=n.n(c),i=n(2),o=n(7),s=(n(45),n(46),n(47),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function u(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l=n(10),d=function(e){return e.selection},j=function(e){return e.game&&e.game.streak},f=function(e){return N(e)?k(e):e.game&&e.game.board},b=function(e){return e.game&&e.game.score},h=Object(l.a)((function(e){return!!function(e){return e.game}(e)}),(function(e){return e})),v=Object(l.a)(j,(function(e){return e&&e.type})),O=Object(l.a)(j,(function(e){return e&&e.count})),m=Object(l.a)(d,(function(e){return e.squares})),x=Object(l.a)(d,(function(e){return e.size})),g=Object(l.a)(d,(function(e){return e.hidden})),p=Object(l.a)(g,(function(e){return e})),y=function(e){return Object(l.a)(f,m,g,(function(t,n,r){var c=n.includes(e);return{type:t&&t[e],active:c,inactive:n.length>0&&!c,hidden:r&&c,ready:4===n.length&&c}}))},_=function(e){return e.tutorial.message[e.tutorial.step]},k=function(e){return e.tutorial.board[e.tutorial.step]},N=function(e){return e.tutorial.active},w=function(e){return e.options},q=Object(l.a)(w,(function(e){return e.inputMode})),S=Object(l.a)(w,(function(e){return e.hues})),M=n(12),C=n.n(M),D="/play",A="/options",H="/tutorial",T=n(11),W=n(4),G=n(27),L=n.n(G),E=n(32),U=n(6),I=n(36),P=n.n(I),R=n(5),z={active:!1,board:[[3,3,3,3,3,3,3,3,3,1,3,1,3,3,3,3,3,3,3,3,3,3,3,1,3,1,3,3,3,3,3,3,3,3,3],[3,3,0,3,3,3,3,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,0,3,3],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3],[3,0,3,3,3,1,3,3,2,1,3,3,3,0,3,3,3,3,3,0,3,3,3,3,3,1,2,1,3,2,1,3,2,2,3]],message:["Welcome!\n         Find a square with corners of the same color and remove it by connecting two opposite corners.","Squares have different sizes and orientations. Removing bigger squares yields a higher score.","Removing multiple squares of the same color in a row  will multiply your score.","The game won\u2019t tell you when there aren\u2019t any squares left to remove.\n         You have to call it quits.\n         Enjoy!"],step:0},F=n(37),B=n(33),Y={board:null,bucket:[],score:0,streak:null},J="TOUCH",X="CLICK",K=Array(3).fill(0),Q={hues:K,inputMode:J},$=n(14),V=n.n($),Z=n(26),ee=n.n(Z),te=n(34),ne=n.n(te),re=function(e,t,n){var r=e.x,c=e.y;return{x:r*n+t.x*(1-n),y:c*n+t.y*(1-n)}},ce=function e(t,n){var r=t.x,c=t.y;return n?e({x:c,y:-r},n-1):{x:r,y:c}},ae=V()((function(e,t,n){return function(e,t){var n=e.x,r=e.y;return{x:n+t.x,y:r+t.y}}(ce(function(e,t){var n=e.x,r=e.y;return{x:n-t.x,y:r-t.y}}(t,e),n),e)})),ie=function(e,t){var n=e.x,r=e.y,c=t.x,a=t.y;return Math.hypot(n-c,r-a)},oe={squares:[],size:0,hidden:!1},se=V()((function(e){return e.x+7*e.y})),ue=V()((function(e,t){var n=t.x,r=t.y;return 0<=n&&n<7&&n%1===0&&0<=r&&r<e.length/7&&r%1===0})),le=function(e,t){return e[se(t)]},de=V()((function(e,t,n){return le(e,n)===t})),je=V()((function(e,t){return le(e,t)<3})),fe=function(e){return{selection:oe,resetSelection:function(){return e(Object(R.a)((function(e){e.selection=oe})))},updateSelection:function(t,n){return e(Object(R.a)((function(e){var r=function(e,t,n){return Object(U.a)(Object(U.a)({},oe),{},{size:ie(t,n),squares:ne()(C()(0,4).map(ae(re(t,n,.5),t)).filter(ue(e)).filter(je(e)).filter(de(e,le(e,t))).map(se))})}(f(e),t,n);ee()(r.squares,e.selection.squares)||(e.selection=r)})))},hideSelection:function(){return e(Object(R.a)((function(e){e.selection.squares.length<4?e.selection=oe:e.selection.hidden=!0})))}}},be=n(21),he=n.n(be),ve=n(35);function Oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;return Object(T.a)(Array(t)).reduce((function(e){var t=Object(W.a)(e,2),a=t[0],i=t[1];0===(i=Object(T.a)(i)).length&&(i=Object(T.a)(Array((r-n)*c)).map((function(e,t){return t%(r-n)+n})));var o=Math.random()*i.length|0,s=i.splice(o,1)[0];return[[].concat(Object(T.a)(a),[s]),i]}),[[],e])}var me=Object(ve.configurePersist)({storage:localStorage}).persist,xe=P()(Object(F.devtools)(me({key:"quood",allowlist:["game","highscore","options"]},(function(e,t){return Object(U.a)(Object(U.a)(Object(U.a)(Object(U.a)(Object(U.a)(Object(U.a)({},function(e){return{highscore:0,updateHighscore:function(){return e(Object(R.a)((function(e){e.highscore=Math.max(e.highscore,b(e))})))}}}(e)),function(e){return{tutorial:z,startTutorial:function(){return e(Object(R.a)((function(e){e.tutorial.step=0,e.tutorial.active=!0})))},endTutorial:function(){return e(Object(R.a)((function(e){e.tutorial.active=!1})))},advanceTutorial:function(){return e(Object(R.a)((function(e){e.tutorial.step+=1})))}}}(e)),function(e){return{game:null,initGame:function(t){return e(Object(R.a)((function(e){e.game=Object(U.a)(Object(U.a)({},Y),{},{board:t})})))},replaceSquares:function(t,n){return e(Object(R.a)((function(e){var r,c=m(e),a=x(e),i=e.game.board[c[0]],o=Object(B.a)(c);try{for(o.s();!(r=o.n()).done;){var s=r.value;e.game.board[s]=t.pop()}}catch(l){o.e(l)}finally{o.f()}var u=e.game.streak&&e.game.streak.type===i?e.game.streak.count+1:1;e.game.score=e.game.score+(0|a)*u,e.game.streak={count:u,type:i},e.game.bucket=n})))}}}(e)),function(e){return{options:Q,changeHue:function(t,n){return e(Object(R.a)((function(e){var r=Object(T.a)(e.options.hues);r[t]=n,e.options.hues=r})))},resetHues:function(){return e(Object(R.a)((function(e){e.options.hues=K})))},changeInputMode:function(){return e(Object(R.a)((function(e){e.options.inputMode=e.options.inputMode===X?J:X})))}}}(e)),fe(e)),{},{match:function(){var e=Object(E.a)(L.a.mark((function e(){var n,r,c,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t().hideSelection(),e.next=3,he()(0);case 3:if(g(t())){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,he()(500);case 7:if(!N(t())){e.next=11;break}t().advanceTutorial(),e.next=16;break;case 11:return n=Oe((i=t()).game&&i.game.bucket,4),r=Object(W.a)(n,2),c=r[0],a=r[1],t().replaceSquares(c,a),e.next=15,he()(0);case 15:t().updateHighscore();case 16:t().resetSelection();case 17:case"end":return e.stop()}var i}),e)})));return function(){return e.apply(this,arguments)}}(),assureGame:function(){if(!h(t())){var e=Oe([],49),n=Object(W.a)(e,1)[0];t().initGame(n)}},startGame:function(){var e=Oe([],49),n=Object(W.a)(e,1)[0];t().initGame(n)}})})))),ge=n(0);function pe(e){var t=e.index,n=xe((function(e){return[S(e),y(t)(e)]})),r=Object(W.a)(n,2),c=r[0],a=r[1],i={filter:"hue-rotate(".concat(c[a.type],"deg)")},o="square",s=Object.entries(a).filter((function(e){var t=Object(W.a)(e,2);t[0];return!1!==t[1]})).map((function(e){var t=Object(W.a)(e,2),n=t[0],r=t[1];return"".concat(o,"_").concat(n).concat(!0===r?"":"_"+r)})),u=[o].concat(Object(T.a)(s)).join(" ");return Object(ge.jsx)("button",{className:u,style:i})}function ye(e){var t=e.isLocked,n=void 0!==t&&t,c=e.onDragUpdate,a=e.onDragEnd,i=void 0===a?function(){}:a,o=e.onDragAbort,s=void 0===o?function(){}:o,u=e.zIndex,l=void 0===u?1e4:u,d=Object(r.useRef)(),j=Object(r.useState)(null),f=Object(W.a)(j,2),b=f[0],h=f[1],v={height:"100%",position:"absolute",width:"100%",zIndex:l};function O(){!n&&b&&(h(null),s())}return Object(ge.jsx)("div",{style:v,"touch-action":"none",onPointerDown:function(e){return function(e){if(!n){var t=_e(e,d);h(t),c(t,t)}}(e)},onPointerUp:function(e){!n&&b&&(h(null),i())},onPointerMove:function(e){return function(e){b&&c(b,_e(e,d))}(e)},onPointerCancel:function(){return O()},onPointerLeave:function(){return O()},onPointerOut:function(){return O()},onLostPointerCapture:function(){return O()},ref:d})}function _e(e,t){var n=t.current.getBoundingClientRect(),r=n.x,c=n.y,a=e.pageX,i=e.pageY,o=t.current;return{x:(a-r)/o.offsetWidth,y:(i-c)/o.offsetHeight}}function ke(e){var t=e.gridWidth,n=e.gridHeight,c=e.isLocked,a=e.onDragAbort,i=e.onDragEnd,o=e.onDragUpdate,s=Object(r.useState)(null),u=Object(W.a)(s,2),l=u[0],d=u[1];return Object(ge.jsx)(ye,{onDragAbort:function(){d(null),a()},onDragEnd:function(){d(null),i()},onDragUpdate:function(e,r){var c={x:e.x*t|0,y:e.y*n|0},a={x:r.x*t|0,y:r.y*n|0};l&&r.x===l.x&&r.y===l.y||(d(r),o(c,a))},isLocked:c})}function Ne(e){var t=e.onClick,n=e.onMouseMove,c=void 0===n?function(){}:n,a=e.zIndex,i=void 0===a?1e4:a,o=Object(r.useRef)(),s={height:"100%",position:"absolute",width:"100%",zIndex:i};return Object(ge.jsx)("div",{onClick:function(e){t(we(e,o))},onMouseMove:function(e){c(we(e,o))},ref:o,style:s})}function we(e,t){var n=t.current.getBoundingClientRect(),r=n.x,c=n.y,a=e.pageX,i=e.pageY,o=t.current;return{x:(a-r)/o.offsetWidth,y:(i-c)/o.offsetHeight}}function qe(e){var t=e.gridWidth,n=e.gridHeight,c=e.onDragAbort,a=e.onDragEnd,i=e.onDragUpdate,o=e.isLocked,s=Object(r.useState)(null),u=Object(W.a)(s,2),l=u[0],d=u[1],j=Object(r.useState)(null),f=Object(W.a)(j,2),b=f[0],h=f[1];return Object(ge.jsx)(Ne,{onClick:function(e){if(!o){var r={x:e.x*t|0,y:e.y*n|0};l?r.x===l.x&&r.y===l.y?(d(null),h(null),c()):(d(null),h(null),a()):(d(r),h(r),i(r,r))}},onMouseMove:function(e){if(!o&&l){var r={x:e.x*t|0,y:e.y*n|0};b&&r.x===b.x&&r.y===b.y||(h(r),i(l,r))}}})}function Se(e){var t=e.isTutorial,n=void 0!==t&&t,r=xe((function(e){return{isBoardLocked:p(e),inputMode:q(e),match:e.match,resetSelection:e.resetSelection,updateSelection:e.updateSelection}})),c=r.isBoardLocked,a=r.inputMode,i=r.match,o=r.resetSelection,s=r.updateSelection,u=n?5:7,l=C()(0,7*u).map((function(e){return Object(ge.jsx)("div",{className:"board__square",children:Object(ge.jsx)(pe,{index:e})},e)}));return Object(ge.jsxs)("div",{className:"board".concat(n?" board_tutorial":""),children:[a===J&&Object(ge.jsx)(ke,{gridWidth:7,gridHeight:u,onDragEnd:function(){return i()},onDragUpdate:function(e,t){return s(e,t)},onDragAbort:function(){return o()},isLocked:c}),a===X&&Object(ge.jsx)(qe,{gridWidth:7,gridHeight:u,onDragEnd:function(){return i()},onDragUpdate:function(e,t){return s(e,t)},onDragAbort:function(){return o()},isLocked:c}),l]})}var Me=n(13),Ce=n(40),De=["children","onClick"];var Ae=function(e){var t=e.children,n=e.onClick,r=void 0===n?function(){}:n,c=Object(Ce.a)(e,De);return Object(ge.jsx)(Me.a,Object(U.a)(Object(U.a)({},c),{},{onClick:r,children:t||"Back"}))};var He=function(){var e=xe((function(e){return{highscore:e.highscore,hues:S(e),isGameActive:h(e),score:b(e),streakCount:O(e),streakType:v(e)}})),t=e.highscore,n=e.hues,r=e.isGameActive,c=e.score,a=e.streakCount,i=e.streakType;if(!r)return null;var o={filter:"hue-rotate(".concat(n[i],"deg)")};return Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsx)("div",{className:"menu",children:Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsxs)("div",{className:"stat",children:[Object(ge.jsx)("div",{className:"stat__title",children:"Score"}),Object(ge.jsx)("div",{className:"stat__value",children:c})]}),Object(ge.jsxs)("div",{className:"stat",children:[Object(ge.jsx)("div",{className:"stat__title",children:"Streak"}),a>0&&Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsx)("div",{className:"stat__square",children:Object(ge.jsx)("div",{className:"square square_type_".concat(i),style:o})}),Object(ge.jsx)("div",{className:"stat__value",children:a})]})]}),Object(ge.jsxs)("div",{className:"stat",children:[Object(ge.jsx)("div",{className:"stat__title",children:"Highscore"}),Object(ge.jsx)("div",{className:"stat__value",children:t})]})]})}),Object(ge.jsxs)("div",{className:"main-menu",children:[Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Ae,{to:"/"})}),Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Me.a,{to:A,children:"Options"})})]})]})};var Te=function(){var e=xe((function(e){return{isActive:h(e),assureGame:e.assureGame,resetSelection:e.resetSelection}})),t=e.isActive,n=e.assureGame,c=e.resetSelection;return Object(r.useEffect)((function(){n(),c()}),[n,c]),t?Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsx)(Se,{}),Object(ge.jsx)(He,{})]}):null};var We=function(){var e=xe(S),t={filter:"hue-rotate(".concat(e[1],"deg)")},n=C()(0,49).map((function(e){return Object(ge.jsx)("div",{className:"board__square",children:Object(ge.jsx)("div",{className:"square square_type_1",style:t})},e)}));return Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsxs)("div",{className:"board board_title",children:[Object(ge.jsx)("div",{className:"board__title",children:"Quood"}),n]}),Object(ge.jsxs)("div",{className:"main-menu",children:[Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Me.a,{to:D,children:"Play"})}),Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Me.a,{to:H,children:"Tutorial"})})]})]})};var Ge=function(){var e=xe((function(e){return[e.endTutorial,_(e),e.resetSelection,e.startTutorial]})),t=Object(W.a)(e,4),n=t[0],c=t[1],a=t[2],i=t[3];return Object(r.useEffect)((function(){return i(),a(),n}),[n,a,i]),Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsx)(Se,{isTutorial:!0}),Object(ge.jsx)("div",{className:"menu",children:Object(ge.jsx)("div",{className:"message",children:c})}),Object(ge.jsxs)("div",{className:"main-menu",children:[Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Ae,{to:"/"})}),Object(ge.jsx)("div",{className:"main-menu__action main-menu__action_inactive"})]})]})};function Le(e){var t=e.index,n=xe((function(e){return{changeHue:e.changeHue,hue:S(e)[t],inputMode:q(e)}})),r=n.changeHue,c=n.hue,a=n.inputMode,i={filter:"hue-rotate(".concat(c,"deg)")};return Object(ge.jsxs)("div",{className:"slider",children:[Object(ge.jsx)("div",{className:"slider__square",children:Object(ge.jsx)("div",{className:"square square_type_".concat(t),style:i})}),Object(ge.jsxs)("div",{className:"slider__bar-border",children:[a===J&&Object(ge.jsx)(ye,{onDragUpdate:function(e,n){r(t,360*n.x|0)}}),a===X&&Object(ge.jsx)(Ne,{onClick:function(e){r(t,360*e.x|0)}}),Object(ge.jsx)("div",{className:"slider__bar",style:{width:"".concat(c/3.6,"%")}})]})]})}var Ee=function(){var e=xe((function(e){return{changeInputMode:e.changeInputMode,inputMode:q(e),startGame:e.startGame,resetHues:e.resetHues}})),t=e.changeInputMode,n=e.inputMode,r=e.startGame,c=e.resetHues,a=C()(0,3).map((function(e){return Object(ge.jsx)(Le,{index:e},e)}));return Object(ge.jsxs)(ge.Fragment,{children:[Object(ge.jsxs)("div",{className:"menu",children:[Object(ge.jsxs)("div",{className:"menu__block",children:[Object(ge.jsx)("div",{className:"options-headline",children:"Input Mode"}),Object(ge.jsx)("button",{className:"action",onClick:function(){return t()},children:n===J?"Touch":"Click"})]}),Object(ge.jsxs)("div",{className:"menu__block",children:[Object(ge.jsx)("div",{className:"options-headline",children:"Square Colors"}),a,Object(ge.jsx)("button",{className:"action",onClick:function(){return c()},children:"Reset"})]})]}),Object(ge.jsxs)("div",{className:"main-menu",children:[Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Ae,{to:D})}),Object(ge.jsx)("div",{className:"main-menu__action",children:Object(ge.jsx)(Ae,{to:D,onClick:function(){return r()},children:"Restart"})})]})]})},Ue=Object(o.b)();a.a.render(Object(ge.jsx)(i.b,{history:Ue,children:Object(ge.jsxs)(i.c,{children:[Object(ge.jsx)(i.a,{exact:!0,path:"/",render:function(){return Object(ge.jsx)(We,{})}}),Object(ge.jsx)(i.a,{exact:!0,path:D,render:function(){return Object(ge.jsx)(Te,{})}}),Object(ge.jsx)(i.a,{exact:!0,path:H,render:function(){return Object(ge.jsx)(Ge,{})}}),Object(ge.jsx)(i.a,{exact:!0,path:A,render:function(){return Object(ge.jsx)(Ee,{})}})]})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");s?(!function(e,t){fetch(e).then((function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):u(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):u(t,e)}))}}()}},[[74,1,2]]]);
//# sourceMappingURL=main.e600c13a.chunk.js.map