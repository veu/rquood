(this.webpackJsonprquood=this.webpackJsonprquood||[]).push([[0],{47:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(31),a=n.n(c),i=n(2),o=n(7);n(45),n(46),n(47),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(10),u=function(e){return e.selection},l=function(e){return e.game&&e.game.streak},d=function(e){return e.game&&e.game.board},j=function(e){return e.game&&e.game.score},b=Object(s.a)((function(e){return!!function(e){return e.game}(e)}),(function(e){return e})),f=Object(s.a)(l,(function(e){return e&&e.type})),h=Object(s.a)(l,(function(e){return e&&e.count})),O=Object(s.a)(u,(function(e){return e.squares})),m=Object(s.a)(u,(function(e){return e.size})),x=Object(s.a)(u,(function(e){return e.hidden})),v=Object(s.a)(x,(function(e){return e})),g=function(e,t){return Object(s.a)(d,y,O,x,(function(n,r,c,a){var i=c.includes(t),o=e?r:n;return{type:o&&o[t],active:i,inactive:c.length>0&&!i,hidden:a&&i,ready:4===c.length&&i}}))},p=function(e){return e.tutorial.message[e.tutorial.step]},y=function(e){return e.tutorial.board[e.tutorial.step]},_=function(e){return e.options},k=Object(s.a)(_,(function(e){return e.inputMode})),N=Object(s.a)(_,(function(e){return e.hues})),q=n(12),S=n.n(q),M="/play",w="/options",C="/tutorial",D=n(11),H=n(4),T=n(27),A=n.n(T),G=n(32),I=n(6),L=n(36),E=n.n(L),P=n(5),U={board:[[3,3,3,3,3,3,3,3,3,1,3,1,3,3,3,3,3,3,3,3,3,3,3,1,3,1,3,3,3,3,3,3,3,3,3],[3,3,0,3,3,3,3,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,0,3,3,3,3,3,3,3,3,3,0,3,3],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,0,3,3,3,3,3,0,0,3,3,3,3,3,3,3,3,3,3],[3,0,3,3,3,1,3,3,2,1,3,3,3,0,3,3,3,3,3,0,3,3,3,3,3,1,2,1,3,2,1,3,2,2,3]],message:["Welcome!\n         Find a square with corners of the same color and remove it by connecting two opposite corners.","Squares have different sizes and orientations. Removing bigger squares yields a higher score.","Removing multiple squares of the same color in a row  will multiply your score.","The game won\u2019t tell you when there aren\u2019t any squares left to remove.\n         You have to call it quits.\n         Enjoy!"],step:0},W=n(37),z=n(33),F={board:null,bucket:[],score:0,streak:null},R="TOUCH",B="CLICK",Y=Array(3).fill(0),J={hues:Y,inputMode:R},X=n(14),K=n.n(X),Q=n(26),$=n.n(Q),V=n(34),Z=n.n(V),ee=function(e,t,n){var r=e.x,c=e.y;return{x:r*n+t.x*(1-n),y:c*n+t.y*(1-n)}},te=function e(t,n){var r=t.x,c=t.y;return n?e({x:c,y:-r},n-1):{x:r,y:c}},ne=K()((function(e,t,n){return function(e,t){var n=e.x,r=e.y;return{x:n+t.x,y:r+t.y}}(te(function(e,t){var n=e.x,r=e.y;return{x:n-t.x,y:r-t.y}}(t,e),n),e)})),re=function(e,t){var n=e.x,r=e.y,c=t.x,a=t.y;return Math.hypot(n-c,r-a)},ce={squares:[],size:0,hidden:!1},ae=K()((function(e){return e.x+7*e.y})),ie=K()((function(e,t){var n=t.x,r=t.y;return 0<=n&&n<7&&n%1===0&&0<=r&&r<e.length/7&&r%1===0})),oe=function(e,t){return e[ae(t)]},se=K()((function(e,t,n){return oe(e,n)===t})),ue=K()((function(e,t){return oe(e,t)<3})),le=function(e){return{selection:ce,resetSelection:function(){return e(Object(P.a)((function(e){e.selection=ce})))},updateSelection:function(t,n){return e(Object(P.a)((function(e){var r=function(e,t,n){return Object(I.a)(Object(I.a)({},ce),{},{size:re(t,n),squares:Z()(S()(0,4).map(ne(ee(t,n,.5),t)).filter(ie(e)).filter(ue(e)).filter(se(e,oe(e,t))).map(ae))})}(d(e),t,n);$()(r.squares,e.selection.squares)||(e.selection=r)})))},hideSelection:function(){return e(Object(P.a)((function(e){e.selection.squares.length<4?e.selection=ce:e.selection.hidden=!0})))}}},de=n(21),je=n.n(de),be=n(35);function fe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;return Object(D.a)(Array(t)).reduce((function(e){var t=Object(H.a)(e,2),a=t[0],i=t[1];0===(i=Object(D.a)(i)).length&&(i=Object(D.a)(Array((r-n)*c)).map((function(e,t){return t%(r-n)+n})));var o=Math.random()*i.length|0,s=i.splice(o,1)[0];return[[].concat(Object(D.a)(a),[s]),i]}),[[],e])}var he=Object(be.configurePersist)({storage:localStorage}).persist,Oe=E()(Object(W.devtools)(he({key:"quood",allowlist:["game","highscore","options"]},(function(e,t){return Object(I.a)(Object(I.a)(Object(I.a)(Object(I.a)(Object(I.a)(Object(I.a)({},function(e){return{highscore:0,updateHighscore:function(){return e(Object(P.a)((function(e){e.highscore=Math.max(e.highscore,j(e))})))}}}(e)),function(e){return{tutorial:U,startTutorial:function(){return e(Object(P.a)((function(e){e.tutorial.step=0})))},advanceTutorial:function(){return e(Object(P.a)((function(e){e.tutorial.step+=1})))}}}(e)),function(e){return{game:null,initGame:function(t){return e(Object(P.a)((function(e){e.game=Object(I.a)(Object(I.a)({},F),{},{board:t})})))},replaceSquares:function(t,n){return e(Object(P.a)((function(e){var r,c=O(e),a=m(e),i=e.game.board[c[0]],o=Object(z.a)(c);try{for(o.s();!(r=o.n()).done;){var s=r.value;e.game.board[s]=t.pop()}}catch(l){o.e(l)}finally{o.f()}var u=e.game.streak&&e.game.streak.type===i?e.game.streak.count+1:1;e.game.score=e.game.score+(0|a)*u,e.game.streak={count:u,type:i},e.game.bucket=n})))}}}(e)),function(e){return{options:J,changeHue:function(t,n){return e(Object(P.a)((function(e){var r=Object(D.a)(e.options.hues);r[t]=n,e.options.hues=r})))},resetHues:function(){return e(Object(P.a)((function(e){e.options.hues=Y})))},changeInputMode:function(){return e(Object(P.a)((function(e){e.options.inputMode=e.options.inputMode===B?R:B})))}}}(e)),le(e)),{},{match:function(){var e=Object(G.a)(A.a.mark((function e(n){var r,c,a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t().hideSelection(),e.next=3,je()(0);case 3:if(x(t())){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,je()(500);case 7:if(!n){e.next=11;break}t().advanceTutorial(),e.next=16;break;case 11:return r=fe((o=t()).game&&o.game.bucket,4),c=Object(H.a)(r,2),a=c[0],i=c[1],t().replaceSquares(a,i),e.next=15,je()(0);case 15:t().updateHighscore();case 16:t().resetSelection();case 17:case"end":return e.stop()}var o}),e)})));return function(t){return e.apply(this,arguments)}}(),assureGame:function(){if(!b(t())){var e=fe([],49),n=Object(H.a)(e,1)[0];t().initGame(n)}},startGame:function(){var e=fe([],49),n=Object(H.a)(e,1)[0];t().initGame(n)}})})))),me=n(0);function xe(e){var t=e.index,n=e.isTutorial,r=void 0!==n&&n,c=Oe((function(e){return[N(e),g(r,t)(e)]})),a=Object(H.a)(c,2),i=a[0],o=a[1],s={filter:"hue-rotate(".concat(i[o.type],"deg)")},u="square",l=Object.entries(o).filter((function(e){var t=Object(H.a)(e,2);t[0];return!1!==t[1]})).map((function(e){var t=Object(H.a)(e,2),n=t[0],r=t[1];return"".concat(u,"_").concat(n).concat(!0===r?"":"_"+r)})),d=[u].concat(Object(D.a)(l)).join(" ");return Object(me.jsx)("button",{className:d,style:s})}function ve(e){var t=e.isLocked,n=void 0!==t&&t,c=e.onDragUpdate,a=e.onDragEnd,i=void 0===a?function(){}:a,o=e.onDragAbort,s=void 0===o?function(){}:o,u=e.zIndex,l=void 0===u?1e4:u,d=Object(r.useRef)(),j=Object(r.useState)(null),b=Object(H.a)(j,2),f=b[0],h=b[1],O={height:"100%",position:"absolute",width:"100%",zIndex:l};function m(){!n&&f&&(h(null),s())}return Object(me.jsx)("div",{style:O,"touch-action":"none",onPointerDown:function(e){return function(e){if(!n){var t=ge(e,d);h(t),c(t,t)}}(e)},onPointerUp:function(e){!n&&f&&(h(null),i())},onPointerMove:function(e){return function(e){f&&c(f,ge(e,d))}(e)},onPointerCancel:function(){return m()},onPointerLeave:function(){return m()},onPointerOut:function(){return m()},onLostPointerCapture:function(){return m()},ref:d})}function ge(e,t){var n=t.current.getBoundingClientRect(),r=n.x,c=n.y,a=e.pageX,i=e.pageY,o=t.current;return{x:(a-r)/o.offsetWidth,y:(i-c)/o.offsetHeight}}function pe(e){var t=e.gridWidth,n=e.gridHeight,c=e.isLocked,a=e.onDragAbort,i=e.onDragEnd,o=e.onDragUpdate,s=Object(r.useState)(null),u=Object(H.a)(s,2),l=u[0],d=u[1];return Object(me.jsx)(ve,{onDragAbort:function(){d(null),a()},onDragEnd:function(){d(null),i()},onDragUpdate:function(e,r){var c={x:e.x*t|0,y:e.y*n|0},a={x:r.x*t|0,y:r.y*n|0};l&&r.x===l.x&&r.y===l.y||(d(r),o(c,a))},isLocked:c})}function ye(e){var t=e.onClick,n=e.onMouseMove,c=void 0===n?function(){}:n,a=e.zIndex,i=void 0===a?1e4:a,o=Object(r.useRef)(),s={height:"100%",position:"absolute",width:"100%",zIndex:i};return Object(me.jsx)("div",{onClick:function(e){t(_e(e,o))},onMouseMove:function(e){c(_e(e,o))},ref:o,style:s})}function _e(e,t){var n=t.current.getBoundingClientRect(),r=n.x,c=n.y,a=e.pageX,i=e.pageY,o=t.current;return{x:(a-r)/o.offsetWidth,y:(i-c)/o.offsetHeight}}function ke(e){var t=e.gridWidth,n=e.gridHeight,c=e.onDragAbort,a=e.onDragEnd,i=e.onDragUpdate,o=e.isLocked,s=Object(r.useState)(null),u=Object(H.a)(s,2),l=u[0],d=u[1],j=Object(r.useState)(null),b=Object(H.a)(j,2),f=b[0],h=b[1];return Object(me.jsx)(ye,{onClick:function(e){if(!o){var r={x:e.x*t|0,y:e.y*n|0};l?r.x===l.x&&r.y===l.y?(d(null),h(null),c()):(d(null),h(null),a()):(d(r),h(r),i(r,r))}},onMouseMove:function(e){if(!o&&l){var r={x:e.x*t|0,y:e.y*n|0};f&&r.x===f.x&&r.y===f.y||(h(r),i(l,r))}}})}function Ne(e){var t=e.isTutorial,n=void 0!==t&&t,r=Oe((function(e){return{discardSelection:e.discardSelection,isBoardLocked:v(e),inputMode:k(e),match:e.match,updateSelection:e.updateSelection}})),c=r.discardSelection,a=r.isBoardLocked,i=r.inputMode,o=r.match,s=r.updateSelection,u=n?5:7,l=S()(0,7*u).map((function(e){return Object(me.jsx)("div",{className:"board__square",children:Object(me.jsx)(xe,{index:e,isTutorial:n})},e)}));return Object(me.jsxs)("div",{className:"board",children:[i===R&&Object(me.jsx)(pe,{gridWidth:7,gridHeight:u,onDragEnd:function(){return o(n)},onDragUpdate:function(e,t){return s(e,t)},onDragAbort:function(){return c()},isLocked:a}),i===B&&Object(me.jsx)(ke,{gridWidth:7,gridHeight:u,onDragEnd:function(){return o(n)},onDragUpdate:function(e,t){return s(e,t)},onDragAbort:function(){return c()},isLocked:a}),l]})}var qe=n(13),Se=n(40),Me=["children","onClick"];var we=function(e){var t=e.children,n=e.onClick,r=void 0===n?function(){}:n,c=Object(Se.a)(e,Me);return Object(me.jsx)(qe.a,Object(I.a)(Object(I.a)({},c),{},{onClick:r,children:t||"Back"}))};var Ce=function(){var e=Oe((function(e){return{highscore:e.highscore,hues:N(e),isGameActive:b(e),score:j(e),streakCount:h(e),streakType:f(e)}})),t=e.highscore,n=e.hues,r=e.isGameActive,c=e.score,a=e.streakCount,i=e.streakType;if(!r)return null;var o={filter:"hue-rotate(".concat(n[i],"deg)")};return Object(me.jsxs)(me.Fragment,{children:[Object(me.jsx)("div",{className:"menu",children:Object(me.jsxs)(me.Fragment,{children:[Object(me.jsxs)("div",{className:"stat",children:[Object(me.jsx)("div",{className:"stat__title",children:"Score"}),Object(me.jsx)("div",{className:"stat__value",children:c})]}),Object(me.jsxs)("div",{className:"stat",children:[Object(me.jsx)("div",{className:"stat__title",children:"Streak"}),a>0&&Object(me.jsxs)(me.Fragment,{children:[Object(me.jsx)("div",{className:"stat__square",children:Object(me.jsx)("div",{className:"square square_type_".concat(i),style:o})}),Object(me.jsx)("div",{className:"stat__value",children:a})]})]}),Object(me.jsxs)("div",{className:"stat",children:[Object(me.jsx)("div",{className:"stat__title",children:"Highscore"}),Object(me.jsx)("div",{className:"stat__value",children:t})]})]})}),Object(me.jsxs)("div",{className:"main-menu",children:[Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(we,{to:"/"})}),Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(qe.a,{to:w,children:"Options"})})]})]})};var De=function(){var e=Oe((function(e){return{isActive:b(e),assureGame:e.assureGame,resetSelection:e.resetSelection}})),t=e.isActive,n=e.assureGame,c=e.resetSelection;return Object(r.useEffect)((function(){n(),c()}),[n,c]),t?Object(me.jsxs)(me.Fragment,{children:[Object(me.jsx)(Ne,{}),Object(me.jsx)(Ce,{})]}):null};var He=function(){var e=Oe(N),t={filter:"hue-rotate(".concat(e[1],"deg)")},n=S()(0,49).map((function(e){return Object(me.jsx)("div",{className:"board__square",children:Object(me.jsx)("div",{className:"square square_type_1",style:t})},e)}));return Object(me.jsxs)(me.Fragment,{children:[Object(me.jsxs)("div",{className:"board board_title",children:[Object(me.jsx)("div",{className:"board__title",children:"Quood"}),n]}),Object(me.jsxs)("div",{className:"main-menu",children:[Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(qe.a,{to:M,children:"Play"})}),Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(qe.a,{to:C,children:"Tutorial"})})]})]})};var Te=function(){var e=Oe((function(e){return[p(e),e.resetSelection,e.startTutorial]})),t=Object(H.a)(e,3),n=t[0],c=t[1],a=t[2];return Object(r.useEffect)((function(){a(),c()}),[c,a]),Object(me.jsxs)(me.Fragment,{children:[Object(me.jsx)(Ne,{isTutorial:!0}),Object(me.jsx)("div",{className:"menu",children:Object(me.jsx)("div",{className:"message",children:n})}),Object(me.jsxs)("div",{className:"main-menu",children:[Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(we,{to:"/"})}),Object(me.jsx)("div",{className:"main-menu__action main-menu__action_inactive"})]})]})};function Ae(e){var t=e.index,n=Oe((function(e){return{changeHue:e.changeHue,hue:N(e)[t],inputMode:k(e)}})),r=n.changeHue,c=n.hue,a=n.inputMode,i={filter:"hue-rotate(".concat(c,"deg)")};return Object(me.jsxs)("div",{className:"slider",children:[Object(me.jsx)("div",{className:"slider__square",children:Object(me.jsx)("div",{className:"square square_type_".concat(t),style:i})}),Object(me.jsxs)("div",{className:"slider__bar-border",children:[a===R&&Object(me.jsx)(ve,{onDragUpdate:function(e,n){r(t,360*n.x|0)}}),a===B&&Object(me.jsx)(ye,{onClick:function(e){r(t,360*e.x|0)}}),Object(me.jsx)("div",{className:"slider__bar",style:{width:"".concat(c/3.6,"%")}})]})]})}var Ge=function(){var e=Oe((function(e){return{changeInputMode:e.changeInputMode,inputMode:k(e),startGame:e.startGame,resetHues:e.resetHues}})),t=e.changeInputMode,n=e.inputMode,r=e.startGame,c=e.resetHues,a=S()(0,3).map((function(e){return Object(me.jsx)(Ae,{index:e},e)}));return Object(me.jsxs)(me.Fragment,{children:[Object(me.jsxs)("div",{className:"menu",children:[Object(me.jsxs)("div",{className:"menu__block",children:[Object(me.jsx)("div",{className:"options-headline",children:"Input Mode"}),Object(me.jsx)("button",{className:"action",onClick:function(){return t()},children:n===R?"Touch":"Click"})]}),Object(me.jsxs)("div",{className:"menu__block",children:[Object(me.jsx)("div",{className:"options-headline",children:"Square Colors"}),a,Object(me.jsx)("button",{className:"action",onClick:function(){return c()},children:"Reset"})]})]}),Object(me.jsxs)("div",{className:"main-menu",children:[Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(we,{to:M})}),Object(me.jsx)("div",{className:"main-menu__action",children:Object(me.jsx)(we,{to:M,onClick:function(){return r()},children:"Restart"})})]})]})},Ie=Object(o.b)();a.a.render(Object(me.jsx)(i.b,{history:Ie,children:Object(me.jsxs)(i.c,{children:[Object(me.jsx)(i.a,{exact:!0,path:"/",render:function(){return Object(me.jsx)(He,{})}}),Object(me.jsx)(i.a,{exact:!0,path:M,render:function(){return Object(me.jsx)(De,{})}}),Object(me.jsx)(i.a,{exact:!0,path:C,render:function(){return Object(me.jsx)(Te,{})}}),Object(me.jsx)(i.a,{exact:!0,path:w,render:function(){return Object(me.jsx)(Ge,{})}})]})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[74,1,2]]]);
//# sourceMappingURL=main.e0d50971.chunk.js.map